--
-- Script was generated by Devart dbForge Studio 2019 for MySQL, Version 8.2.23.0
-- Product home page: http://www.devart.com/dbforge/mysql/studio
-- Script date 6/9/2022 11:01:22 PM
-- Server version: 5.6.50-log
-- Client version: 4.1
--

-- 
-- Disable foreign keys
-- 
/*!40014 SET @OLD_FOREIGN_KEY_CHECKS=@@FOREIGN_KEY_CHECKS, FOREIGN_KEY_CHECKS=0 */;

-- 
-- Set SQL mode
-- 
/*!40101 SET @OLD_SQL_MODE=@@SQL_MODE, SQL_MODE='NO_AUTO_VALUE_ON_ZERO' */;

-- 
-- Set character set the client will use to send SQL statements to the server
--
SET NAMES 'utf8';

--
-- Set default database
--
USE heroku_1d035cff01f5848;

--
-- Drop table `employee`
--
DROP TABLE IF EXISTS employee;

--
-- Drop table `employee_project_mapping`
--
DROP TABLE IF EXISTS employee_project_mapping;

--
-- Drop table `issue`
--
DROP TABLE IF EXISTS issue;

--
-- Drop table `notification`
--
DROP TABLE IF EXISTS notification;

--
-- Drop table `project`
--
DROP TABLE IF EXISTS project;

--
-- Drop table `role`
--
DROP TABLE IF EXISTS role;

--
-- Drop table `role_permission`
--
DROP TABLE IF EXISTS role_permission;

--
-- Drop procedure `Proc_GetDictionaryByFormLayout`
--
DROP PROCEDURE IF EXISTS Proc_GetDictionaryByFormLayout;

--
-- Drop procedure `proc_statement`
--
DROP PROCEDURE IF EXISTS proc_statement;

--
-- Drop table `issue_dictionary_data`
--
DROP TABLE IF EXISTS issue_dictionary_data;

--
-- Drop table `issue_dictionary`
--
DROP TABLE IF EXISTS issue_dictionary;

--
-- Set default database
--
USE heroku_1d035cff01f5848;

--
-- Create table `issue_dictionary`
--
CREATE TABLE issue_dictionary (
  ID bigint(20) NOT NULL AUTO_INCREMENT,
  FieldName varchar(255) NOT NULL,
  DictionaryName varchar(255) NOT NULL,
  Active tinyint(1) DEFAULT NULL,
  CreatedDate datetime DEFAULT NULL,
  CreatedBy varchar(255) DEFAULT NULL,
  ModifiedDate datetime DEFAULT NULL,
  ModifiedBy varchar(255) DEFAULT NULL,
  PRIMARY KEY (ID)
)
ENGINE = INNODB,
AUTO_INCREMENT = 14,
AVG_ROW_LENGTH = 5461,
CHARACTER SET utf8,
COLLATE utf8_general_ci;

--
-- Create table `issue_dictionary_data`
--
CREATE TABLE issue_dictionary_data (
  ID bigint(20) NOT NULL AUTO_INCREMENT,
  DictionaryID bigint(20) NOT NULL,
  Value int(11) DEFAULT NULL,
  Text varchar(255) DEFAULT NULL,
  Active tinyint(1) DEFAULT NULL,
  SortOrder int(11) DEFAULT NULL,
  CreatedDate datetime DEFAULT NULL,
  CreatedBy varchar(255) DEFAULT NULL,
  ModifiedDate datetime DEFAULT NULL,
  ModifiedBy varchar(255) DEFAULT NULL,
  PRIMARY KEY (ID)
)
ENGINE = INNODB,
AUTO_INCREMENT = 124,
AVG_ROW_LENGTH = 1365,
CHARACTER SET utf8,
COLLATE utf8_general_ci;

--
-- Create foreign key
--
ALTER TABLE issue_dictionary_data
ADD CONSTRAINT issue_dictionary_data_ibfk_1 FOREIGN KEY (DictionaryID)
REFERENCES issue_dictionary (ID);

DELIMITER $$

--
-- Create procedure `proc_statement`
--
CREATE DEFINER = 'b7f925ce22548b'@'%'
PROCEDURE proc_statement (IN dynamic_statement mediumtext)
BEGIN
  SET @dynamic_statement := dynamic_statement;
  PREPARE prepare_statment FROM @dynamic_statement;
  EXECUTE prepare_statment;

  DEALLOCATE PREPARE prepare_statment;
END
$$

--
-- Create procedure `Proc_GetDictionaryByFormLayout`
--
CREATE DEFINER = 'b7f925ce22548b'@'%'
PROCEDURE Proc_GetDictionaryByFormLayout (IN v_LayoutCode varchar(255))
BEGIN
  DECLARE v_DicTable varchar(255);
  DECLARE v_DicDataTable varchar(255);
  DECLARE v_Query text;

  SET v_DicTable = CONCAT(v_LayoutCode, '_dictionary');
  SET v_DicDataTable = CONCAT(v_LayoutCode, '_dictionary_data');

  SET v_Query = CONCAT('SELECT dtt.* FROM ', v_DicDataTable,
  ' dtt JOIN ', v_DicTable, ' dt ON dt.ID = dtt.DictionaryID WHERE dt.FieldName = ''Type''');
  CALL proc_statement(v_Query);

  SET v_Query = CONCAT('SELECT dtt.* FROM ', v_DicDataTable,
  ' dtt JOIN ', v_DicTable, ' dt ON dt.ID = dtt.DictionaryID WHERE dt.FieldName = ''Priority''');
  CALL proc_statement(v_Query);

  SET v_Query = CONCAT('SELECT dtt.* FROM ', v_DicDataTable,
  ' dtt JOIN ', v_DicTable, ' dt ON dt.ID = dtt.DictionaryID WHERE dt.FieldName = ''State''');
  CALL proc_statement(v_Query);

END
$$

DELIMITER ;

--
-- Create table `role_permission`
--
CREATE TABLE role_permission (
  ID bigint(20) NOT NULL AUTO_INCREMENT,
  RoleID bigint(20) NOT NULL,
  Permission bigint(20) NOT NULL,
  ModifiedDate datetime DEFAULT NULL,
  ModifiedBy varchar(255) DEFAULT NULL,
  CreatedDate datetime DEFAULT NULL,
  CreatedBy varchar(255) DEFAULT NULL,
  LayoutCode varchar(50) DEFAULT NULL,
  PRIMARY KEY (ID)
)
ENGINE = INNODB,
AUTO_INCREMENT = 10,
AVG_ROW_LENGTH = 1820,
CHARACTER SET utf8,
COLLATE utf8_general_ci;

--
-- Create table `role`
--
CREATE TABLE role (
  ID bigint(20) NOT NULL AUTO_INCREMENT,
  RoleName varchar(255) NOT NULL,
  Description varchar(255) NOT NULL,
  ModifiedDate datetime DEFAULT NULL,
  ModifiedBy varchar(255) DEFAULT NULL,
  CreatedDate datetime DEFAULT NULL,
  CreatedBy varchar(255) DEFAULT NULL,
  PRIMARY KEY (ID)
)
ENGINE = INNODB,
AUTO_INCREMENT = 4,
AVG_ROW_LENGTH = 5461,
CHARACTER SET utf8,
COLLATE utf8_general_ci;

--
-- Create table `project`
--
CREATE TABLE project (
  ID bigint(20) NOT NULL AUTO_INCREMENT,
  ProjectName varchar(255) NOT NULL DEFAULT '',
  ProjectCode varchar(50) NOT NULL DEFAULT '',
  ModifiedDate datetime DEFAULT NULL,
  ModifiedBy varchar(255) DEFAULT NULL,
  CreatedDate datetime DEFAULT NULL,
  CreatedBy varchar(255) DEFAULT NULL,
  PRIMARY KEY (ID)
)
ENGINE = INNODB,
AUTO_INCREMENT = 24,
AVG_ROW_LENGTH = 8192,
CHARACTER SET utf8,
COLLATE utf8_unicode_ci;

--
-- Create table `notification`
--
CREATE TABLE notification (
  ID bigint(20) NOT NULL AUTO_INCREMENT,
  FromUserID bigint(20) NOT NULL,
  ToUserID bigint(20) NOT NULL,
  LayoutCode varchar(50) DEFAULT NULL,
  EventName varchar(50) DEFAULT NULL,
  Config mediumtext DEFAULT NULL,
  Content varchar(500) DEFAULT NULL,
  ModifiedDate datetime DEFAULT NULL,
  ModifiedBy varchar(255) DEFAULT NULL,
  CreatedDate datetime DEFAULT NULL,
  CreatedBy varchar(255) DEFAULT NULL,
  PRIMARY KEY (ID)
)
ENGINE = INNODB,
CHARACTER SET utf8,
COLLATE utf8_general_ci;

--
-- Create table `issue`
--
CREATE TABLE issue (
  ID int(11) NOT NULL AUTO_INCREMENT,
  TypeID int(11) DEFAULT NULL,
  TypeIDText varchar(255) DEFAULT NULL,
  Subject varchar(255) DEFAULT NULL,
  PriorityID int(11) DEFAULT NULL,
  PriorityIDText varchar(255) DEFAULT NULL,
  StatusID int(11) DEFAULT NULL,
  StatusIDText varchar(255) DEFAULT NULL,
  AssignedTo varchar(36) DEFAULT NULL,
  FoundInBuild varchar(255) DEFAULT NULL,
  IntergratedBuild varchar(255) DEFAULT NULL,
  CreatedBy varchar(255) CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci DEFAULT NULL,
  CreatedDate datetime DEFAULT NULL,
  ModifiedBy varchar(255) CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci DEFAULT NULL,
  ModifiedDate datetime DEFAULT NULL,
  AssignedUserID bigint(20) DEFAULT NULL,
  AssignedUserIDText varchar(255) DEFAULT NULL,
  ProjectID bigint(20) DEFAULT NULL,
  ProjectIDText varchar(255) DEFAULT NULL,
  PRIMARY KEY (ID)
)
ENGINE = INNODB,
AUTO_INCREMENT = 104,
AVG_ROW_LENGTH = 2340,
CHARACTER SET utf8,
COLLATE utf8_general_ci;

--
-- Create table `employee_project_mapping`
--
CREATE TABLE employee_project_mapping (
  ID bigint(20) NOT NULL AUTO_INCREMENT,
  EmployeeID bigint(20) NOT NULL,
  ProjectID bigint(20) NOT NULL,
  ModifiedDate datetime DEFAULT NULL,
  ModifiedBy varchar(255) DEFAULT NULL,
  CreatedDate datetime DEFAULT NULL,
  CreatedBy varchar(255) DEFAULT NULL,
  PRIMARY KEY (ID)
)
ENGINE = INNODB,
AUTO_INCREMENT = 44,
AVG_ROW_LENGTH = 8192,
CHARACTER SET utf8,
COLLATE utf8_general_ci;

--
-- Create table `employee`
--
CREATE TABLE employee (
  ID bigint(20) NOT NULL DEFAULT 0,
  EmployeeID varchar(36) DEFAULT NULL,
  FullName varchar(255) DEFAULT NULL,
  RoleID smallint(4) DEFAULT 1,
  Email varchar(500) DEFAULT NULL,
  PhoneNumber varchar(50) DEFAULT NULL,
  ModifiedDate datetime DEFAULT NULL,
  ModifiedBy varchar(255) DEFAULT NULL,
  CreatedDate datetime DEFAULT NULL,
  CreatedBy varchar(255) DEFAULT NULL,
  Username char(255) DEFAULT NULL,
  Password varchar(500) DEFAULT NULL,
  FirstName varchar(100) DEFAULT NULL,
  LastName varchar(100) DEFAULT NULL,
  IsActived tinyint(1) DEFAULT 1,
  PRIMARY KEY (ID)
)
ENGINE = INNODB,
AVG_ROW_LENGTH = 3276,
CHARACTER SET utf8,
COLLATE utf8_general_ci;

-- 
-- Dumping data for table issue_dictionary
--
INSERT INTO issue_dictionary VALUES
(1, 'Type', 'Kiểu vấn đề', 1, '2022-03-22 09:56:42', 'Hoàng Hải Đăng', NULL, NULL),
(2, 'Priority', 'Mức độ ưu tiên', 1, '2022-03-22 09:57:26', 'Hoàng Hải Đăng', NULL, NULL),
(3, 'State', 'Trạng thái', 1, '2022-03-22 09:58:21', 'Hoàng Hải Đăng', NULL, NULL);

-- 
-- Dumping data for table role_permission
--
INSERT INTO role_permission VALUES
(1, 1, 63, '2022-05-24 15:35:29', 'admin', '2022-05-24 15:35:29', 'admin', 'Project'),
(2, 1, 63, '2022-05-24 15:35:29', 'admin', '2022-05-24 15:35:29', 'admin', 'Member'),
(3, 1, 63, '2022-05-24 15:35:29', 'admin', '2022-05-24 15:35:29', 'admin', 'Issue'),
(4, 2, 1, '2022-05-24 15:36:56', 'admin', '2022-05-24 15:36:56', 'admin', 'Project'),
(5, 2, 1, '2022-05-24 15:36:56', 'admin', '2022-05-24 15:36:56', 'admin', 'Member'),
(6, 2, 15, '2022-05-24 15:36:56', 'admin', '2022-05-24 15:36:56', 'admin', 'Issue'),
(7, 3, 1, '2022-05-24 15:38:55', 'admin', '2022-05-24 15:38:55', 'admin', 'Project'),
(8, 3, 1, '2022-05-24 15:38:55', 'admin', '2022-05-24 15:38:55', 'admin', 'Member'),
(9, 3, 7, '2022-05-24 15:38:55', 'admin', '2022-05-24 15:38:55', 'admin', 'Issue');

-- 
-- Dumping data for table role
--
INSERT INTO role VALUES
(1, 'Admin', 'Quản trị hệ thống có toàn quyền trong hệ thống', '2022-05-24 14:39:04', 'admin', '2022-05-24 14:39:04', 'admin'),
(2, 'Member', 'Nhân viên có 1 số quyền cơ bản', '2022-05-24 14:39:04', 'admin', '2022-05-24 14:39:04', 'admin'),
(3, 'Guest', '', '2022-05-24 14:39:04', 'admin', '2022-05-24 14:39:04', 'admin');

-- 
-- Dumping data for table project
--
INSERT INTO project VALUES
(4, 'Project Test', 'PRT_123', '2022-04-23 10:30:13', 'Hoàng Hải Đăng', '2022-04-23 10:30:13', 'Hoàng Hải Đăng'),
(14, 'CRM MISA', 'CRM_522', '2022-04-24 11:17:11', 'Hoàng Hải Đăng', '2022-04-24 11:17:11', 'Hoàng Hải Đăng');

-- 
-- Dumping data for table notification
--
-- Table heroku_1d035cff01f5848.notification does not contain any data (it is empty)

-- 
-- Dumping data for table issue_dictionary_data
--
INSERT INTO issue_dictionary_data VALUES
(1, 1, 1, 'Task', 1, 1, '2022-03-22 10:43:28', 'Hoàng Hải Đăng', '2022-05-13 15:43:05', 'Hoàng Hải Đăng'),
(2, 1, 2, 'Bug', 1, 2, '2022-03-22 10:43:28', 'Hoàng Hải Đăng', '2022-05-13 15:43:05', 'Hoàng Hải Đăng'),
(3, 1, 3, 'Request', 1, 3, '2022-03-22 10:43:28', 'Hoàng Hải Đăng', '2022-05-13 15:43:05', 'Hoàng Hải Đăng'),
(4, 1, 4, 'Other', 1, 4, '2022-03-22 10:43:28', 'Hoàng Hải Đăng', '2022-05-13 15:43:05', 'Hoàng Hải Đăng'),
(5, 2, 1, 'Low', 1, 1, '2022-03-22 10:45:22', 'Hoàng Hải Đăng', '2022-05-13 15:43:05', 'Hoàng Hải Đăng'),
(6, 2, 2, 'Normal', 1, 2, '2022-03-22 10:45:22', 'Hoàng Hải Đăng', '2022-05-13 15:43:05', 'Hoàng Hải Đăng'),
(7, 2, 3, 'High', 1, 3, '2022-03-22 10:45:22', 'Hoàng Hải Đăng', '2022-05-13 15:43:05', 'Hoàng Hải Đăng'),
(74, 3, 1, 'New', 1, 1, '2022-03-22 10:50:27', 'Hoàng Hải Đăng', '2022-05-13 15:43:05', 'Hoàng Hải Đăng'),
(84, 3, 2, 'Approved', 1, 2, '2022-03-22 10:50:27', 'Hoàng Hải Đăng', '2022-05-13 15:43:05', 'Hoàng Hải Đăng'),
(94, 3, 3, 'Commited', 1, 3, '2022-03-22 10:50:27', 'Hoàng Hải Đăng', '2022-05-13 15:43:05', 'Hoàng Hải Đăng'),
(104, 3, 4, 'Done', 1, 4, '2022-03-22 10:50:27', 'Hoàng Hải Đăng', '2022-05-13 15:43:05', 'Hoàng Hải Đăng'),
(114, 3, 5, 'Removed', 1, 5, '2022-03-22 10:50:27', 'Hoàng Hải Đăng', '2022-05-13 15:43:05', 'Hoàng Hải Đăng');

-- 
-- Dumping data for table issue
--
INSERT INTO issue VALUES
(14, 0, 'Task', 'Can''t add ticket', 2, 'Normal', 1, 'Approved', 'HHDANG', 'R24.0.16', 'R25.0.01', 'Hoàng Hải Đăng', '2022-05-13 16:26:28', 'Hoàng Hải Đăng', '2022-05-13 16:26:28', 4, 'Hoàng Hải Đăng', 4, 'Project Test'),
(24, 2, 'Request', 'dafa', 2, 'Normal', 1, 'Approved', 'hhdang', '', '', 'Hoàng Hải Đăng', '2022-05-13 16:26:28', 'Hoàng Hải Đăng', '2022-05-13 16:26:28', 4, 'Hoàng Hải Đăng', 4, 'Project Test'),
(34, 1, 'Bug', 'data', 3, 'High', 0, 'New', 'HHDANG', 'R26.0.1', '', 'Hoàng Hải Đăng', '2022-05-13 16:26:28', 'Hoàng Hải Đăng', '2022-05-13 16:26:28', 4, 'Hoàng Hải Đăng', 4, 'Project Test'),
(44, 1, 'Bug', 'check response', 2, 'Normal', 1, 'Approved', 'check response', 'check response', 'check response', 'Hoàng Hải Đăng', '2022-05-13 16:26:28', 'Hoàng Hải Đăng', '2022-05-13 16:26:28', 4, 'Hoàng Hải Đăng', 4, 'Project Test'),
(74, 2, 'Request', 'dafa', 2, 'Normal', 1, 'Approved', 'hhdang', '', '', 'Hoàng Hải Đăng', '2022-05-13 16:26:28', 'Hoàng Hải Đăng', '2022-05-13 16:26:28', 4, 'Hoàng Hải Đăng', 4, 'Project Test'),
(84, 1, 'Bug', 'check response', 2, 'Normal', 1, 'Approved', 'check response', 'check response', 'check response', 'Hoàng Hải Đăng', '2022-05-13 16:26:28', 'Hoàng Hải Đăng', '2022-05-13 16:26:28', 4, 'Hoàng Hải Đăng', 4, 'Project Test'),
(94, 2, 'Bug', 'check response', 2, 'Normal', 1, 'New', NULL, '', '', 'Hoàng Hải Đăng', '2022-05-13 16:26:28', 'Hoàng Hải Đăng', '2022-05-13 16:26:28', 4, 'Hoàng Hải Đăng', 4, NULL);

-- 
-- Dumping data for table employee_project_mapping
--
INSERT INTO employee_project_mapping VALUES
(4, 4, 4, '2022-05-24 16:10:30', 'Hoàng Hải Đăng', '2022-05-24 16:10:30', 'Hoàng Hải Đăng'),
(14, 4, 14, '2022-05-24 16:10:30', 'Hoàng Hải Đăng', '2022-05-24 16:10:30', 'Hoàng Hải Đăng'),
(24, 24, 4, '2022-05-29 11:28:13', 'Vu Minh Hoàng', '2022-05-29 11:28:13', 'Vu Minh Hoàng'),
(34, 14, 4, '2022-05-29 11:29:12', 'Vu Minh Hoàng', '2022-05-29 11:29:12', 'Vu Minh Hoàng');

-- 
-- Dumping data for table employee
--
INSERT INTO employee VALUES
(0, 'a1f87790-f7fc-4527-bffc-ae45f4f57b16', 'Hoàng H?i Ðang', 1, 'modimat0165@gmail.com', '0866422499', '2022-05-31 17:13:36', NULL, '2022-05-31 17:13:36', NULL, '', '', 'Hoàng H?i', 'Ðang', 1),
(4, '8797dedd-a73f-11ec-bf05-0ee724d30681', 'Hoàng Hải Đăng', 1, 'haidangk63@gmail.com', NULL, '2022-03-19 05:07:38', ' Hoàng Hải Đăng', '2022-03-19 05:07:38', 'Hoàng Hải Đăng', 'hhdang', '$2a$11$LWPrHOXZIVaRuu8gXqIoNODwRYv5sJJJhKsbIqA.kPDBML0.AbZNm', 'Hoàng Hải', 'Đăng', 1),
(14, '9701b6c6-a73f-11ec-bf05-0ee724d30681', 'Vũ Minh Hoàng', 2, 'hoangvm@gmail.com', NULL, '2022-03-19 05:07:38', ' Hoàng Hải Đăng', '2022-03-19 05:07:38', 'Hoàng Hải Đăng', 'modimat', '$2a$11$LWPrHOXZIVaRuu8gXqIoNODwRYv5sJJJhKsbIqA.kPDBML0.AbZNm', 'Vũ Minh', 'Hoàng', 1),
(24, 'a0fed095-a73f-11ec-bf05-0ee724d30681', 'Vương Văn An', 3, 'anvvm@gmail.com', NULL, '2022-03-19 05:07:38', ' Hoàng Hải Đăng', '2022-03-19 05:07:38', 'Hoàng Hải Đăng', 'dangylpt', 'modimat123', 'Vương Văn', 'An', 1),
(34, 'a9863d48-a73f-11ec-bf05-0ee724d30681', 'Nguyễn Thanh Hằng', 3, 'hangnt@gmail.com', NULL, '2022-03-19 05:07:38', ' Hoàng Hải Đăng', '2022-03-19 05:07:38', 'Hoàng Hải Đăng', '', '', 'Nguyễn Thanh', 'Hằng', 1);

-- 
-- Restore previous SQL mode
-- 
/*!40101 SET SQL_MODE=@OLD_SQL_MODE */;

-- 
-- Enable foreign keys
-- 
/*!40014 SET FOREIGN_KEY_CHECKS = @OLD_FOREIGN_KEY_CHECKS */;